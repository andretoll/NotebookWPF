<Controls:MetroWindow
    xmlns:Controls="http://metro.mahapps.com/winfx/xaml/controls" 
    x:Class="NotebookWPF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:NotebookWPF"
    xmlns:uc="clr-namespace:NotebookWPF.View.UserControls"
    mc:Ignorable="d"
    ShowIconOnTitleBar="True"
    Icon="/Resources/notebook.ico"
    TitleCaps="False"
    MinHeight="450"
    MinWidth="800"
    BorderThickness="0"
    GlowBrush="Black"
    Title="Notebook" Height="600" Width="1200">

    <!--- Icon Template -->
    <Controls:MetroWindow.IconTemplate>
        <DataTemplate>
            <Grid Width="{TemplateBinding Width}"
                 Height="{TemplateBinding Height}"
                 Margin="4"
                 Background="Transparent"
                 RenderOptions.EdgeMode="Aliased"
                 RenderOptions.BitmapScalingMode="HighQuality">
                <Image Source="/Resources/notebook.ico"/>
            </Grid>
        </DataTemplate>
    </Controls:MetroWindow.IconTemplate>

    <!--- Title bar controls -->
    <Controls:MetroWindow.RightWindowCommands>
        <Controls:WindowCommands>

            <!-- Open Settings -->
            <Button x:Name="SettingsButton"
                    Click="SettingsButton_Click"
                    ToolTip="Settings">
                <StackPanel Orientation="Horizontal">
                    <!--- Draw Icon -->
                    <Rectangle Width="20"
                               Height="20"
                               Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}">
                        <Rectangle.OpacityMask>
                            <VisualBrush Stretch="Fill" 
                                         Visual="{StaticResource appbar_settings}" />
                        </Rectangle.OpacityMask>
                    </Rectangle>
                    <!--- Button text -->
                    <TextBlock Margin="4 0 0 0"
                               VerticalAlignment="Center"
                               Text="Settings"/>
                </StackPanel>
            </Button>

        </Controls:WindowCommands>
    </Controls:MetroWindow.RightWindowCommands>

    <!--- Settings Flyout -->
    <Controls:MetroWindow.Flyouts>
        <Controls:FlyoutsControl>
            <Controls:Flyout Header="Settings"
                             x:Name="SettingsFlyout"
                             Position="Left" 
                             Width="400">
                
                <!-- Flyout Content -->
                <uc:SettingsUserControl/>                
                
            </Controls:Flyout>
        </Controls:FlyoutsControl>
    </Controls:MetroWindow.Flyouts>

    <DockPanel>
        
        <!--- Notebooks -->
        <DockPanel DockPanel.Dock="Left">
            
            <!--- Button to trigger new notebook -->
            <Button x:Name="NewNotebookButton"
                    HorizontalAlignment="Left"
                    Click="NewNotebookButton_Click"
                    ToolTip="New notebook"
                    DockPanel.Dock="Top"
                    FontSize="12"
                    Width="140"
                    Style="{StaticResource AccentedSquareButtonStyle}"
                    Margin="10"
                    Padding="10">
                <StackPanel Orientation="Horizontal">
                    <!--- Draw Icon -->
                    <Rectangle Width="20"
                               Height="20"
                               Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}">
                        <Rectangle.OpacityMask>
                            <VisualBrush Stretch="Fill" 
                                         Visual="{StaticResource appbar_book}"/>
                        </Rectangle.OpacityMask>
                    </Rectangle>
                    <!--- Button text -->
                    <TextBlock Margin="4 0 0 0"
                               VerticalAlignment="Center"
                               Text="NEW NOTEBOOK"/>
                </StackPanel>
            </Button>
            
            <!--- Input for new notebook -->
            <Grid DockPanel.Dock="Top"
                  Style="{StaticResource VisibleAnimation}"
                  x:Name="NewNotebookPanel"
                  Visibility="{Binding NewNotebook, Converter={StaticResource nullToVisibilityConverter}}"
                  Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="3*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <!--- Input -->
                <TextBox Grid.Column="0"
                         Text="{Binding NewNotebook.Name, Mode=TwoWay}"
                         x:Name="NewNotebookTextBox"
                         FontSize="14"
                         Margin="0 0 5 0"/>
                <!--- Save -->
                <Button ToolTip="Save"
                        IsEnabled="{Binding ElementName=NewNotebookTextBox, Path=Text.Length}"
                        Style="{StaticResource AccentedSquareButtonStyle}"
                        Command="{Binding AddNotebookCommand}"
                        Grid.Column="1"
                        Margin="0 0 5 0">
                    <TextBlock Text="Save"/>
                </Button>
                <!--- Cancel -->
                <Button ToolTip="Cancel"
                        Width="30"
                        Height="30"
                        Style="{StaticResource AccentedSquareButtonStyle}"
                        Command="{Binding CancelNotebookCommand}"
                        Grid.Column="2">
                    <StackPanel Orientation="Horizontal">
                        <!--- Draw Icon -->
                        <Rectangle Width="15"
                                   Height="15"
                                   Fill="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}">
                            <Rectangle.OpacityMask>
                                <VisualBrush Stretch="Fill" Visual="{DynamicResource appbar_cancel}" />
                            </Rectangle.OpacityMask>
                        </Rectangle>
                    </StackPanel>
                </Button>
            </Grid>
            
            <!--- List of notebooks -->
            <ListBox ItemsSource="{Binding Notebooks}"
                     x:Name="NotebookListBox"
                      BorderThickness="0"
                      Padding="10 0 15 15"
                      VerticalContentAlignment="Top"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.CanContentScroll="False">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <uc:NotebooksUserControl DataContext="{Binding}"/>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
            
            <!--- If no notebooks exists -->
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Top">
                <TextBlock Text="No Notebooks."
                           Margin="0 20 0 0">
                    <TextBlock.Style>
                        <Style BasedOn="{StaticResource LargeText}" TargetType="TextBlock">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Setter Property="Foreground" Value="{DynamicResource AccentColorBrush}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Notebooks.Count}" Value="0">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </StackPanel>
            

        </DockPanel>        

        <!--- Notes -->
        <StackPanel DockPanel.Dock="Left"
                    Margin="15">
        </StackPanel>

        <!--- Separator -->
        <StackPanel Margin="0" Orientation="Horizontal">
            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" 
                       Opacity="0.5"/>
        </StackPanel>

        <!--- Text Editor -->
        <StackPanel>
            
        </StackPanel>
        
    </DockPanel>
    
</Controls:MetroWindow>
